<app-header-login></app-header-login>
<app-owner-menu></app-owner-menu>
<br>
<div class="container mt-5" *ngIf="!showDetails">
  <div class="row">
    <div class="col-md-6">
      <div class="form-group position-relative">
        <input type="text" [(ngModel)]="searchName" class="form-control" placeholder="Pretrazi po nazivu firme" (input)="filterCompaniesByName()">
        <div *ngIf="filteredCompanyNames.length > 0" class="dropdown-menu show" style="width: 100%;">
          <button *ngFor="let name of filteredCompanyNames" class="dropdown-item" (click)="selectCompanyByName(name)">
            {{ name }}
          </button>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="form-group position-relative">
        <input type="text" [(ngModel)]="searchAddress" class="form-control" placeholder="Pretrazi po adresi firme" (input)="filterCompaniesByAddress()">
        <div *ngIf="filteredCompanyAddresses.length > 0" class="dropdown-menu show" style="width: 100%;">
          <button *ngFor="let address of filteredCompanyAddresses" class="dropdown-item" (click)="selectCompanyByAddress(address)">
            {{ address }}
          </button>
        </div>
      </div>
    </div>
  </div>
  <div class="row mt-4">
    <div class="col-12">
      <table class="table table-hover table-bordered">
        <thead class="thead-dark">
          <tr>
            <th (click)="sortByName()" class="text-center">Назив фирме <i class="fas fa-sort"></i></th>
            <th (click)="sortByAddress()" class="text-center">Адреса <i class="fas fa-sort"></i></th>
            <th class="text-center">Ангажовани декоратери</th>
          </tr>
        </thead>
        <tbody *ngIf="filtered == false">
          <tr *ngFor="let company of companies">
            <td><a (click)="viewDetails(company)" class="clickable-name">{{ company.name }}</a></td>
            <td>{{ company.address }}</td>
            <td>
              <ul class="list-unstyled mb-0">
                <li *ngFor="let decorator of getDecorator(company.name)">
                  {{ decorator.name }} {{ decorator.lastname }}
                </li>
              </ul>
            </td>
          </tr>
        </tbody>
        <tbody *ngIf="filtered == true">
          <tr *ngFor="let company of filteredCompanies">
            <td><a (click)="viewDetails(company)" class="clickable-name">{{ company.name }}</a></td>
            <td>{{ company.address }}</td>
            <td>
              <ul class="list-unstyled mb-0">
                <li *ngFor="let decorator of getDecorator(company.name)">
                  {{ decorator.name }} {{ decorator.lastname }}
                </li>
              </ul>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="container mt-5" *ngIf="showDetails">
  <div class="card">
    <div class="card-header">
      <h2>{{ selectedCompany?.name }}</h2>
    </div>
    <div class="card-body">
      <p><strong>Adresa:</strong> {{ selectedCompany?.address }}</p>
      <p><strong>Kontakt osoba:</strong> {{ selectedCompany?.contact }}</p>

      <h3>Usluge</h3>
      <ul class="list-group">
        <li class="list-group-item" *ngFor="let service of selectedCompany?.services">
          {{ service.name }} - {{ service.price | currency:'RSD ':'symbol':'1.2-2' }}
        </li>
      </ul>

      <h3 class="mt-4">Telefon</h3>
      <p>{{ selectedCompany?.contact }}</p>
    </div>
    <div class="card-footer text-right">
      <button class="btn btn-secondary" (click)="showDetails = false">Nazad</button>
    </div>
  </div>
</div>

<app-footer></app-footer>
